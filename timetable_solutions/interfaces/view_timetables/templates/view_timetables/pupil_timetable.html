{% extends "base.html" %}

<head>

{% block head_content %}
<title>{{pupil.firstname}} {{pupil.surname}} Timetable</title>
{% load static %}
<link rel="stylesheet" href="{% static 'view_timetables/stylesheets/pupil_teacher_timetable.css' %}">
{% endblock %}

<style>
{% block style_block %}

#parent_container {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: auto;
}
#content_container {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    background-color: white;
    width: 80%;
    height: 80%;
    padding: 20px;
    margin-top: 45px;
    margin-bottom: 10px;
    border: 3px solid rgba(51, 0, 61, 0.5);
    border-radius: 10px;
    box-shadow: 5px 5px rgba(184, 184, 184, 0.8);
}

{% for subject, colour in class_colours.items %}
.colour_{{ subject }} {
  background-color: {{colour}};
}
{% endfor %}
{% endblock %}
</style>

</head>

<body>
{% block content %}
<div id="parent_container">
    <div id="content_container">
        <h1 class="heading"><i>Timetable for: {{pupil.firstname}} {{pupil.surname}}</i></h1>

        <table>

        {% for time, day_dict in timetable.items %}

        <tr>
            {% if forloop.first %}
            <th style="background-color:#876969;color:white;width:10%">Start time</th>
            {% for day in day_dict %}
            <th class="perimeter" style="width:18%;">{{ day|title }}</th>
            {% endfor %}
            {% endif %}
        </tr>
        <tr>
            <td class="perimeter">{{time}}</td>
            {% for day, klass in day_dict.items %}
            {% if klass == "FREE" %}
              <td class="colour_{{klass}}"><b>{{ klass|title }}</b></td>
            {% elif klass.subject_name == "LUNCH" %}
              <td class="colour_{{klass.subject_name}}"><b>{{ klass.subject_name|title}}</b></td>
            {% else %}
              <td class="colour_{{klass.subject_name}}">
                  <b>{{ klass.subject_name|title}}</b><br>
                  <i>{{ klass.teacher.title }} {{ klass.teacher.surname }}</i><br>
                  <i>{{ klass.classroom.building}} {{klass.classroom.room_number}}</i>
              </td>
            {% endif %}

            {% endfor %}
        </tr>
        {% endfor %}
        </table>
        <button type="button" class="download_button" onclick="download_table_as_csv('{{teacher.firstname}}_{{teacher.surname}}_timetable')">
            Download as CSV
        </button>
        <script src="{% static 'view_timetables/javascript/table_to_csv.js' %}"></script>
    </div>
</div>
{% endblock %}
</body>
